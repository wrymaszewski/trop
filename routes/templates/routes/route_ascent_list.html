{% extends "routes/routes_base.html" %}
{% block route_content %}
{% load cloudinary %}
<h1 class="text-center">{{object.name}}</h1>

  <p><strong>Sector: </strong><a href="{% url 'routes:route_list' slug=object.sector.slug %}">{{object.sector.name}}</a>
  , {{object.sector.region}}, {{object.sector.country}}</p>
  <p><strong>Grade: </strong>{{object.grade}}, {{object.get_scale_display}} scale</p>
  <p><strong>Protection: </strong>{{object.get_protection_display}}</p>
  <p><strong>Average rating: </strong>{% include "routes/_rating.html" %}</p>

  <h3>Descriptions</h3>
  {% for object in object_list%}
  {% if object.description != '' %}
    <div>
      <a href="{% url 'accounts:user_profile' username=object.user.username %}">
        {% cloudinary object.user.userprofile.avatar format="jpg" width=30 height=30 crop="fill" gravity="face" radius="max" %}
      </a>
      <span>{{object.description}}</span>
    </div>
  {% endif %}

  {% endfor %}

{% if object_list %}
  <table class="table datatable">
    <thead>
      <th>Username</th>
      <th>Date</th>
      <th>Style</th>
      <th>Rating</th>
    </thead>
    <tbody>
    {% for object in object_list %}
      <tr>
        <td>
          {% if object.user.userprofile.hidden %}
            Hidden User
          {% else %}
            <a href="{% url 'accounts:user_profile' username=object.user.username%}">{{object.user.username}}</a>
          {% endif %}
        </td>
        <td>{{object.date}}</td>
        <td>{{object.get_ascent_style_display}}</td>
        <td>{% include "routes/_rating.html" %} </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  {% load chartit %}
  {{chart_list|load_charts:"line,pie"}}
  <div id="line"></div>
  <div id="pie"></div>

{% else %}
    <h1>No ascents were found</h1>
{% endif %}
  <a href="{% url 'routes:new_ascent_from_route' route_slug=object.slug sector_slug=sector.slug %}">New Ascent</a>
{% endblock route_content %}
